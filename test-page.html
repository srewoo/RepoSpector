<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Page for AI RepoSpector Extension</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        pre {
            background: #f4f4f4;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
        }
        .test-section {
            margin: 30px 0;
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>AI RepoSpector Extension Test Page</h1>
    <p>This page contains various code blocks to test the extension's code extraction capabilities.</p>

    <div class="test-section">
        <h2>Test 1: Basic Pre Code Block</h2>
        <pre><code>function calculateSum(numbers) {
    return numbers.reduce((sum, num) => sum + num, 0);
}

function calculateAverage(numbers) {
    if (numbers.length === 0) return 0;
    return calculateSum(numbers) / numbers.length;
}

// Test the functions
const testNumbers = [1, 2, 3, 4, 5];
console.log('Sum:', calculateSum(testNumbers));
console.log('Average:', calculateAverage(testNumbers));</code></pre>
    </div>

    <div class="test-section">
        <h2>Test 2: GitHub-style Blob Viewer (data-testid)</h2>
        <div data-testid="blob-viewer-file-content">
class UserService {
    constructor(apiClient) {
        this.apiClient = apiClient;
    }
    
    async getUser(id) {
        try {
            const response = await this.apiClient.get(`/users/${id}`);
            return response.data;
        } catch (error) {
            throw new Error(`Failed to fetch user: ${error.message}`);
        }
    }
    
    async updateUser(id, userData) {
        try {
            const response = await this.apiClient.put(`/users/${id}`, userData);
            return response.data;
        } catch (error) {
            throw new Error(`Failed to update user: ${error.message}`);
        }
    }
    
    async deleteUser(id) {
        try {
            await this.apiClient.delete(`/users/${id}`);
            return true;
        } catch (error) {
            throw new Error(`Failed to delete user: ${error.message}`);
        }
    }
}

module.exports = UserService;
        </div>
    </div>

    <div class="test-section">
        <h2>Test 3: Diff-style Content</h2>
        <div class="diffs tab-pane active">
const oldFunction = () => {
    return 'old implementation';
};

+ const newFunction = () => {
+     return 'new implementation with better logic';
+ };

+ const anotherNewFunction = async (data) => {
+     try {
+         const result = await processData(data);
+         return result;
+     } catch (error) {
+         console.error('Processing failed:', error);
+         throw error;
+     }
+ };

function unchangedFunction() {
    return 'this function remains the same';
}
        </div>
    </div>

    <div class="test-section">
        <h2>Test 4: File Holder Content</h2>
        <div id="fileHolder">
import React, { useState, useEffect } from 'react';

const TodoList = () => {
    const [todos, setTodos] = useState([]);
    const [newTodo, setNewTodo] = useState('');

    useEffect(() => {
        fetchTodos();
    }, []);

    const fetchTodos = async () => {
        try {
            const response = await fetch('/api/todos');
            const todosData = await response.json();
            setTodos(todosData);
        } catch (error) {
            console.error('Failed to fetch todos:', error);
        }
    };

    const addTodo = async () => {
        if (!newTodo.trim()) return;
        
        try {
            const response = await fetch('/api/todos', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text: newTodo })
            });
            
            if (response.ok) {
                const todo = await response.json();
                setTodos([...todos, todo]);
                setNewTodo('');
            }
        } catch (error) {
            console.error('Failed to add todo:', error);
        }
    };

    return (
        &lt;div&gt;
            &lt;h2&gt;Todo List&lt;/h2&gt;
            &lt;input 
                value={newTodo}
                onChange={(e) => setNewTodo(e.target.value)}
                placeholder="Add a new todo..."
            /&gt;
            &lt;button onClick={addTodo}&gt;Add Todo&lt;/button&gt;
            &lt;ul&gt;
                {todos.map(todo => (
                    &lt;li key={todo.id}&gt;{todo.text}&lt;/li&gt;
                ))}
            &lt;/ul&gt;
        &lt;/div&gt;
    );
};

export default TodoList;
        </div>
    </div>

    <div class="test-section">
        <h2>Test 5: Diffs Container</h2>
        <div id="diffs">
class ApiClient {
    constructor(baseURL, timeout = 5000) {
        this.baseURL = baseURL;
        this.timeout = timeout;
        this.headers = {
            'Content-Type': 'application/json'
        };
    }
    
    setAuthToken(token) {
        this.headers['Authorization'] = `Bearer ${token}`;
    }
    
    async request(method, endpoint, data = null) {
        const url = `${this.baseURL}${endpoint}`;
        const options = {
            method,
            headers: this.headers,
            signal: AbortSignal.timeout(this.timeout)
        };
        
        if (data) {
            options.body = JSON.stringify(data);
        }
        
        try {
            const response = await fetch(url, options);
            
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            return await response.json();
        } catch (error) {
            if (error.name === 'AbortError') {
                throw new Error('Request timeout');
            }
            throw error;
        }
    }
    
    get(endpoint) {
        return this.request('GET', endpoint);
    }
    
    post(endpoint, data) {
        return this.request('POST', endpoint, data);
    }
    
    put(endpoint, data) {
        return this.request('PUT', endpoint, data);
    }
    
    delete(endpoint) {
        return this.request('DELETE', endpoint);
    }
}

export default ApiClient;
        </div>
    </div>

    <div class="test-section">
        <h2>Instructions</h2>
        <ol>
            <li>Install the AI RepoSpector extension</li>
            <li>Open this page in Chrome</li>
            <li>Click on the extension icon</li>
            <li>Enter your OpenAI API key in settings if not already configured</li>
            <li>Click "Generate Test Cases"</li>
            <li>The extension should extract code from one of the sections above</li>
        </ol>
        
        <p><strong>Expected behavior:</strong> The extension should find and extract code from any of the test sections above using the new selectors.</p>
    </div>
</body>
</html> 